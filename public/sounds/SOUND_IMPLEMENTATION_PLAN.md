# 🔊 효과음 시스템 구현 계획

## 📋 목표
모든 효과음을 정확한 타이밍과 조건에 맞춰 구현하여 몰입감 있는 게임 경험 제공

---

## 🎵 효과음 목록 및 사용처

### 1️⃣ 화면 전환 및 UI 효과음

#### 1-1. 메인 화면 진입음 (`1-1. 화면 새로고침, 조회.mp3`)
- **사용처**: Main View 진입 시 (최초 로그인 후, 게임 종료 후 메인 복귀)
- **재생 조건**: Main View가 마운트될 때 **단 1회만** 재생
- **구현 위치**: `src/views/Main.js` - useEffect (mount 시)
- **주의사항**: 토글 변경음(1-2)과는 다른 시점에 재생

#### 1-2. 토글 변경음 (`1-2. 토글 변경.mp3`)
- **사용처**: 메인 화면에서 일반/하드 모드 토글 클릭 시
- **재생 조건**: 토글 클릭 시마다 재생
- **재생 시간**: **0.5초만** 재생 (원본 길이의 절반)
- **구현 위치**: `src/views/Main.js` - 토글 클릭 핸들러
- **특수 처리**: Audio의 duration을 0.5초로 제한

#### 1-3. 팝업 열림 (`1-3 팝업 열리는 소리.mp3`)
- **사용처**: 모든 팝업/모달이 열릴 때
- **구현 위치**:
  - Ranking 팝업
  - Settings 팝업
  - Tutorial 팝업
  - 기타 모든 팝업
- **예외**: 하드모드 해금 팝업(1-12)은 제외

#### 1-4. 팝업 닫힘 (`1-4 팝업 닫힐 때 소리.mp3`)
- **사용처**: 모든 팝업/모달이 닫힐 때
- **구현 위치**: 위 1-3과 동일한 팝업들
- **예외**: 하드모드 해금 팝업(1-12)은 제외

#### 2-a. 스플래시 화면 (`2-a 스플래시.mp3`)
- **사용처**: 앱 시작 시 스플래시 화면 진입
- **구현 위치**: `src/views/Splash.js` - useEffect (mount 시)

---

### 2️⃣ 게임 진행 효과음

#### 1-5. 하드모드 진입 (`1-5 하드모드.wav`)
- **사용처**: 하드모드 게임 시작 시 스플래시 화면
- **재생 시간**: **3초만** 재생 (원본 약 7초)
- **구현 위치**: `src/views/GameHard.js` - 하드모드 스플래시 화면
- **타이밍**: Phase 1 안내 메시지 전

#### 1-6. Phase 진입 (`1-6. Phase 진입.mp3`)
- **사용처**: Phase가 변경될 때마다 (일반/하드 모드 공통)
- **재생 시간**: **2초만** 재생 (원본 약 4초)
- **화면 노출 시간**: Phase 안내 화면도 **2초로 통일**
- **구현 위치**:
  - `src/core/GameEngine.js` - Phase 전환 로직
  - `src/core/GameEngineHard.js` - Phase 전환 로직
- **애니메이션**: 페이드인/페이드아웃 효과 유지

---

### 3️⃣ 인게임 상호작용 효과음

#### 1-7. 인게임 클릭음 (`1-7 버튼 클릭.mp3`)
- **사용처**: 게임 중 사용자가 클릭하는 **모든 액션**
- **구현 위치**:
  - `src/games/NumberOrder.js` - 숫자 클릭 시
  - `src/games/ReactionTime.js` - 화면 클릭 시
  - `src/games/WordSearch.js` - 글자 클릭 시 (각 글자마다)
  - `src/games/ColorSequence.js` - 색상 버튼 클릭 시
  - `src/games/PatternMemory.js` - 패턴 클릭 시
  - `src/games/ShapeMatch.js` - 도형 클릭 시
  - `src/games/StroopTest.js` - 답변 선택 시
- **주의사항**: 1-14(일반 버튼 클릭음)과 절대 충돌 금지

#### 1-8. 칼라시퀀스 가이드음 (`1-8 칼라시퀀스 가이드음.mp3`)
- **사용처**: ColorSequence에서 시스템이 순서를 보여줄 때
- **구현 위치**: `src/games/ColorSequence.js` - 시연 단계
- **타이밍**: 각 색상이 하이라이트될 때마다

#### 1-13. Incorrect 오답음 (`1-13 incorrect.mp3`)
- **사용처**: 인게임에서 틀릴 때마다 (일반/하드 모드 공통)
- **구현 위치**:
  - `src/core/GameEngine.js` - 오답 처리
  - `src/core/GameEngineHard.js` - 오답 처리
- **타이밍**: 바이브레이션과 함께 재생

#### 1-15. Correct 정답음 (`1-15) correct.mp3`)
- **사용처**: 인게임에서 정답을 맞출 때
- **구현 위치**: 기존 correct.mp3 사용처와 동일
- **주의사항**: 기존 구현 유지 (파일명만 변경)

---

### 4️⃣ 일반 UI 버튼 클릭음

#### 1-14. 버튼 클릭음 (`1-14) button click.mp3`)
- **사용처**: 인게임이 아닌 모든 버튼 클릭
- **구현 위치**:
  - Splash 화면 - 시작 버튼
  - Main 화면 - 게임 시작 버튼, 랭킹/설정/튜토리얼 버튼
  - Result 화면 - 모든 버튼
  - 기타 모든 UI 버튼
- **예외 처리**:
  - 토글(1-2), 팝업(1-3, 1-4)은 제외
  - **인게임 클릭(1-7)과 절대 충돌 금지**

---

### 5️⃣ 게임 결과 및 보상 효과음

#### 1-9. GameOver 실패 (`1-9 gameover(실패).mp3`)
- **사용처**: 게임오버 시 최대 라운드 미도달
- **재생 조건**:
  - 일반 모드: 현재 라운드 < 사용자의 일반모드 최대 라운드
  - 하드 모드: 현재 라운드 < 사용자의 하드모드 최대 라운드
- **구현 위치**: `src/views/Result.js`
- **데이터 확인**: DB에서 max_round_normal, max_round_hard 조회 필요

#### 1-10. GameOver 성공 (`1-10 gameover(성공).wav`)
- **사용처**: 게임오버 시 최대 라운드 도달/돌파
- **재생 조건**:
  - 일반 모드: 현재 라운드 >= 사용자의 일반모드 최대 라운드
  - 하드 모드: 현재 라운드 >= 사용자의 하드모드 최대 라운드
- **구현 위치**: `src/views/Result.js`
- **타이밍**: 결과 화면이 나타날 때

#### 1-11. 레벨업 (`1-11 레벨 업.wav`)
- **사용처**: 사용자가 레벨업 달성 시
- **구현 위치**: `src/views/Result.js` - 경험치 바 애니메이션
- **재생 조건**:
  - 경험치 바가 가득 차서 레벨업이 발생했을 때
  - 1-9, 1-10 효과음과 **순차적으로** 재생 (겹치지 않게)
- **추가 구현**:
  - ✅ 레벨업 경험치 바 정상 작동 확인
  - ✅ 레벨업 축하 메시지 전체 화면 표시
  - ✅ 동적 애니메이션 (컨페티 효과 활용)
  - ✅ 1-11 효과음과 애니메이션 동기화

#### 1-12. 하드모드 해금 (`1-12 하드모드 해금.mp3`)
- **사용처**: 레벨 5 달성 후 최초 1회
- **재생 조건**:
  - 사용자 레벨 = 5
  - 하드모드 해금 알림을 아직 받지 않음 (로컬스토리지 또는 DB 플래그)
- **구현 위치**: `src/views/Main.js` - useEffect
- **추가 구현**:
  - ✅ 메인 화면 도달 시 최초 1회만 팝업/모달 표시
  - ✅ 팝업 내용: "축하합니다. 지금부터 하드모드 플레이가 가능합니다."
  - ✅ 이 팝업은 1-3, 1-4 효과음 적용 제외
  - ✅ 플래그 저장: localStorage 또는 Supabase DB

---

## 🔧 구현 전략

### Phase 1: AudioManager 확장
- [ ] audioManager.js에 모든 새 효과음 추가
- [ ] 재생 시간 제한 기능 추가 (1-2: 0.5초, 1-5: 3초, 1-6: 2초)
- [ ] 순차 재생 기능 추가 (1-9/1-10 → 1-11)

### Phase 2: View 및 게임 파일 수정
- [ ] Splash.js - 2-a 적용
- [ ] Main.js - 1-1, 1-2, 1-14, 1-12 적용
- [ ] Game.js, GameHard.js - 1-5, 1-6 적용
- [ ] Result.js - 1-9, 1-10, 1-11 적용
- [ ] 모든 게임 파일 - 1-7, 1-13, 1-15 적용
- [ ] ColorSequence.js - 1-8 적용

### Phase 3: 팝업/모달 컴포넌트
- [ ] 팝업 공통 컴포넌트에 1-3, 1-4 적용
- [ ] 하드모드 해금 전용 팝업 생성 (1-12)

### Phase 4: DB 및 데이터 처리
- [ ] max_round_normal, max_round_hard 조회 로직 확인
- [ ] 하드모드 해금 플래그 저장/조회 로직
- [ ] 레벨업 감지 로직 검증

### Phase 5: 테스트 및 검증
- [ ] 모든 효과음이 정확한 타이밍에 재생되는지 확인
- [ ] 효과음 간 충돌이 없는지 확인
- [ ] 재생 시간 제한이 올바르게 작동하는지 확인

---

## ⚠️ 주의사항

1. **인게임(1-7) vs 일반 버튼(1-14) 충돌 방지**
   - 인게임: 1-7 사용
   - 인게임 외: 1-14 사용
   - 명확한 조건 분기 필요

2. **팝업 효과음 예외 처리**
   - 일반 팝업: 1-3, 1-4 사용
   - 하드모드 해금 팝업: 1-3, 1-4 미적용

3. **효과음 순차 재생**
   - 1-9/1-10 → 1-11 순차 재생
   - 겹치지 않도록 타이밍 제어

4. **재생 시간 제한**
   - 1-2: 0.5초
   - 1-5: 3초
   - 1-6: 2초

5. **최초 1회 재생**
   - 1-1: Main View 마운트 시
   - 1-12: 레벨 5 달성 후 메인 화면 진입 시
   - 플래그 관리 필수

---

## 📊 파일 매핑

| 효과음 | 파일명 | 주요 구현 위치 |
|--------|--------|----------------|
| 1-1 | `1-1. 화면 새로고침, 조회.mp3` | Main.js |
| 1-2 | `1-2. 토글 변경.mp3` | Main.js |
| 1-3 | `1-3 팝업 열리는 소리.mp3` | 팝업 공통 컴포넌트 |
| 1-4 | `1-4 팝업 닫힐 때 소리.mp3` | 팝업 공통 컴포넌트 |
| 1-5 | `1-5 하드모드.wav` | GameHard.js |
| 1-6 | `1-6. Phase 진입.mp3` | GameEngine.js, GameEngineHard.js |
| 1-7 | `1-7 버튼 클릭.mp3` | 모든 게임 파일 |
| 1-8 | `1-8 칼라시퀀스 가이드음.mp3` | ColorSequence.js |
| 1-9 | `1-9 gameover(실패).mp3` | Result.js |
| 1-10 | `1-10 gameover(성공).wav` | Result.js |
| 1-11 | `1-11 레벨 업.wav` | Result.js |
| 1-12 | `1-12 하드모드 해금.mp3` | Main.js |
| 1-13 | `1-13 incorrect.mp3` | GameEngine.js, GameEngineHard.js |
| 1-14 | `1-14) button click.mp3` | Splash.js, Main.js, Result.js |
| 1-15 | `1-15) correct.mp3` | 기존 correct 사용처 |
| 2-a | `2-a 스플래시.mp3` | Splash.js |

---

## ✅ 체크리스트

- [ ] 계획 수립 완료
- [ ] AudioManager 확장
- [ ] 모든 View 파일 수정
- [ ] 모든 게임 파일 수정
- [ ] 팝업/모달 처리
- [ ] DB 데이터 처리
- [ ] 최종 테스트
- [ ] 문서 업데이트
